CREATE OR REPLACE FUNCTION sankhya.FC_RETORNA_DEPRECIACAO_PDS
(
  P_IDINV   NUMBER

)
RETURN INT IS
   
/************************************************************************************************
NOME AUTOR: Diego Teixeira de Almeida
DATA......: 13/06/2023
BANCO DE DADOS: ORACLE
OBJETIVO..: Retorna a depreciação do mês vigente. É feito a  subtração da data atual - a data de abertura do projeto e então
multiplicado por 12 meses para então atribuir a depreciação da parcela referente ao mês vigente contida na tela Cadastrar Projeto - PDS.

PARAMETROS DE ENTRADA:
         P_IDINV: Numero do projeto
         
EXEMPLO DE USO: SELECT MCTY_RETORNA_MESES_DEPRECIADOS( P_IDINV) FROM DUAL
*************************************************************************************************/
    V_RESULT INT;
BEGIN
    
SELECT 
CASE (((EXTRACT(YEAR FROM SYSDATE))-(EXTRACT(YEAR FROM P.DTP)))*10)
WHEN 1 THEN PI.M1
WHEN 2 THEN PI.M2
WHEN 3 THEN PI.M3
WHEN 4 THEN PI.M4
WHEN 5 THEN PI.M5
WHEN 6 THEN PI.M6
WHEN 7 THEN PI.M7
WHEN 8 THEN PI.M8
WHEN 9 THEN PI.M9
WHEN 10 THEN PI.M10
WHEN 11 THEN PI.M11
WHEN 12 THEN PI.M12
WHEN 13 THEN PI.M13
WHEN 14 THEN PI.M14
WHEN 15 THEN PI.M15
WHEN 16 THEN PI.M16
WHEN 17 THEN PI.M17
WHEN 18 THEN PI.M18
WHEN 19 THEN PI.M19
WHEN 20 THEN PI.M20
WHEN 21 THEN PI.M21
WHEN 22 THEN PI.M22
WHEN 23 THEN PI.M23
WHEN 24 THEN PI.M24
WHEN 25 THEN PI.M25
WHEN 26 THEN PI.M26
WHEN 26 THEN PI.M27
WHEN 28 THEN PI.M28
WHEN 29 THEN PI.M29
WHEN 30 THEN PI.M30
WHEN 31 THEN PI.M31
WHEN 31	THEN M31
WHEN 32	THEN M32
WHEN 33	THEN M33
WHEN 34	THEN M34
WHEN 35	THEN M35
WHEN 36	THEN M36
WHEN 37	THEN M37
WHEN 38	THEN M38
WHEN 39	THEN M39
WHEN 40	THEN M40
WHEN 41	THEN M41
WHEN 42	THEN M42
WHEN 43	THEN M43
WHEN 44	THEN M44
WHEN 45	THEN M45
WHEN 46	THEN M46
WHEN 47	THEN M47
WHEN 48	THEN M48
WHEN 49	THEN M49
WHEN 50	THEN M50
WHEN 51	THEN M51
WHEN 52	THEN M52
WHEN 53	THEN M53
WHEN 54	THEN M54
WHEN 55	THEN M55
WHEN 56	THEN M56
WHEN 57	THEN M57
WHEN 58	THEN M58
WHEN 59	THEN M59
WHEN 60	THEN M60
WHEN 61	THEN M61
WHEN 62	THEN M62
WHEN 63	THEN M63
WHEN 64	THEN M64
WHEN 65	THEN M65
WHEN 66	THEN M66
WHEN 67	THEN M67
WHEN 68	THEN M68
WHEN 69	THEN M69
WHEN 70	THEN M70
WHEN 71	THEN M71
WHEN 72	THEN M72
END DEPRECIACAO
INTO V_RESULT
FROM AD_TPFPINV P, AD_TPFPFLUXO PI
WHERE   P.IDINV = PI.IDINV
AND     P.IDINV = P_IDINV
AND     PI.DESCRICAO = 'Depreciação';

RETURN V_RESULT;
    
END;